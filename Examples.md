Each averaged image is produced by sampling frames from a video and applying a some OpenCV image processing operations.  Those operations are described below:

- The video is sampled at a rate specified by the 'total_samples' value of the MovieFingerprint object (default is 250 per video).  OpenCV unfortunately forces you to read in each frame sequentially which is the largset bottleneck by far.
- If a frame is selected for sampling, it is then converted from BGR (OpenCV default color space, just reordered RGB) to HSV (aka HSI).  
- It also became clear early on the Histogram Equalization of each frame was required to prevent dark and bright spots from overwhelming the image.  The exact implementation was not as obvious.

>
```python
hsv_image = cv2.cvtColor(bgr_image, cv2.COLOR_BGR2HSV)  # Convert BGR image to HSV
hsv_image[:, :, 1] = cv2.equalizeHist(hsv_image[:, :, 1])  # Histogram equalization of S channel; 0-H, 1-S, 2-V
```
>
Channelbreakdown with and without Histogram Equalization on each channel:
<img src=images/Layers_HistEQ.PNG width="1000">

- After lots experimentation, conversion to HSV color space, and then Histogram Equalization on the S and V channels was the best combination:
<img src=images/HistEQ_Channel_Comparison.PNG width="1000">


Below are a few example images generated by moviefingerprint:

Ghost in the Shell
![Ghost in the Shell](https://gitlab.com/danielorf/moviefingerprint/raw/master/images/Ghost%20in%20the%20Shell%20(1995).jpg)


Lawrence of Arabia
![Lawrence of Arabia](https://gitlab.com/danielorf/moviefingerprint/raw/master/images/Lawrence%20of%20Arabia.jpg)


Wild
![Wild](https://gitlab.com/danielorf/moviefingerprint/raw/master/images/Wild.jpg)


Twin Peaks - Fire Walk With Me
![Twin Peaks - Fire Walk With Me](https://gitlab.com/danielorf/moviefingerprint/raw/master/images/Twin%20Peaks%20-%20Fire%20Walk%20With%20Me.jpg)
